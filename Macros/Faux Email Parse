Sub GetFromFolder()

Dim olNS, olApp, olMail, olSelection, olFolder, olExplorer As Object
Dim mailLoop, mailCount As Double
Dim todayDate, mailReceived As Date
Dim ws As Worksheet
Dim mailSubject As String

Set olApp = CreateObject("Outlook.Application")
Set olNS = olApp.GetNameSpace("MAPI")
Set olFolder = olNS.GetDefaultFolder(olFolderInbox)
Set olMail = olFolder.Items
Set olExplorer = olApp.ActiveExplorer
Set olSelection = olExplorer.Selection
Set ws = ActiveSheet

mailCount = olFolder.Items.Count
todayDate = Date

For mailLoop = mailCount To 1 Step -1
    With olSelection
        Set olMail = olFolder.Items(mailLoop)
            mailSubject = olMail.Subject
            mailReceived = Format(olMail.ReceivedTime, "DD/MM/YYYY")
                    If mailSubject Like "AJB bell file" Then
                        If (mailReceived = todayDate) Then
                            ws.Range("A1").Value = .Subject
                            ws.Range("B1").Value = .ReceivedTime
                            ws.Range("C1").Value = .SenderName
                        Else
                        End If
                    Else
                    End If
    End With
Next mailLoop

End Sub
