Public rowCount As Integer

Sub Macro1()
'
' Macro1 Macro
'
    Columns("K:K").Select
    Selection.ClearContents
 
    'deletes row 1
    Rows("1:1").Select
    Selection.Delete Shift:=xlUp
    
    'reformat base data
    Columns("A:D").Select
    Selection.Delete Shift:=xlToLeft
    Columns("A:A").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("G:G").Select
    Selection.Cut
    Columns("A:A").Select
    ActiveSheet.Paste
    Columns("C:C").Select
    Selection.Cut
    Columns("G:G").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Selection.Cut
    Columns("C:C").Select
    ActiveSheet.Paste
    
    'Select new C range and add decimal places
    ActiveSheet.Range("C:C").Select
    Selection.NumberFormat = "0.00"
    
    'Enter last 2 digits of date, ledger number, narrative
    rowCount = Range("A65536").End(xlUp).Row
    For i = 1 To rowCount
        Cells(i, 4).Value = "*CASH"
        Cells(i, 5).Value = Right(Year(Date), 2)
        Cells(i, 6).Value = "6"
        Cells(i, 7).Value = "Funds Received " & Format(DateTime.Now - 1, "DD/MM/YYYY")
    Next i
    
    'Move work to A5
    rowCount = Range("A65536").End(xlUp).Row
    Range("A1", "G" & rowCount).Select
    Selection.Cut
    Cells(5, 1).Select
    ActiveSheet.Paste

    TodayDate = Format(DateTime.Now, "DD/MM/YYYY")

    'Enter values at top
    Cells(1, 1).Value = "Funds Received - D060N (PS)"
    Cells(2, 1).Value = "GBP"
    Range("A3").Select
    Selection.NumberFormat = "@"
    Cells(3, 1).Value = TodayDate

    'Change =TODAY() formula to number value
    Cells(3, 1).Select
    Cells(3, 1).Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.NumberFormat = "dd/mm/yyyy;@"

    'clear all contents from H and I column
    Columns("H:I").Select
    Selection.Clear
    
         'saves journal
    ActiveWorkbook.SaveAs Filename:= _
    "S:\BankOps\Payment Processing\1 - Client Facing Services\Cash Allocations\CPW consignments\D060N Uploads\D060n Journal Upload " & Format(DateTime.Now, "DD.MM.YY HH:MM:SS") & ".csv", FileFormat:=xlCSV _
    , CreateBackup:=False
'
End Sub


